<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1>
    
    <a href="https://github.com/EricVernie/AuthentificationInTeams/blob/main/Tab.md"
       target="_blank" title="Tutoriels auth">Authentifier un utilisateur dans un onglet Microsoft Teams</a>
    </h1>
    <p/>
    <b>Jeton d'accès : </b>
    <div type="text" id="AccessToken"></div>
    <p />
    <button onclick="Authenticate()">s'authentifier</button>


    <!-- Microsoft Teams JavaScript API (via CDN) -->
    <script src="https://statics.teams.microsoft.com/sdk/v1.6.0/js/MicrosoftTeams.min.js" crossorigin="anonymous"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            Authenticate();
        });

        // Utilisation du SDK Teams pour l'authentification
        function Authenticate() {
            microsoftTeams.initialize();
            microsoftTeams.getContext((context) => {
                microsoftTeams.authentication.authenticate({
                    url: window.location.origin + "/tab/tabauthenticationstart.html",
                    width: 1024,
                    height: 1024,
                    successCallback: function (result) {
                        console.log(result);
                        $('#AccessToken').text(result.access_token);
                    },
                    failureCallback: function (reason) {
                        $('#Error').text("Login failed: " + reason);
                    }
                });
            });            
        }
    </script>



</body>
</html>